# $This file is distributed under the terms of the license in LICENSE$

@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix auth: <http://vitro.mannlib.cornell.edu/ns/vitro/authorization#> .
@prefix ai: <https://vivoweb.org/ontology/vitro-application/auth/individual/> .
@prefix ao: <https://vivoweb.org/ontology/vitro-application/auth/vocabulary/> .

##### Ontology
<https://vivoweb.org/ontology/vitro-application/auth/vocabulary> rdf:type owl:Ontology .

#### Classes

ao:Policy rdf:type owl:Class ;
     rdfs:label "Access rule policy"@en-US .

ao:TestDatasets rdf:type owl:Class ;
     rdfs:label "Test datasets"@en-US .
     
ao:TestDataset rdf:type owl:Class ;
     rdfs:label "Test dataset"@en-US .
     
ao:TestData rdf:type owl:Class ;
     rdfs:label "Test data"@en-US .
     
ao:TestValue rdf:type owl:Class ;
     rdfs:label "Test value"@en-US .

ao:Rule rdf:type owl:Class ;
     rdfs:label "Access rule"@en-US .
     
ao:PolicyKey rdf:type owl:Class ;
     rdfs:label "Meta access rule key"@en-US .
     
ao:Rules rdf:type owl:Class ;
     rdfs:label "Access rule set"@en-US .

ao:Attribute rdf:type owl:Class ;
     rdfs:label "Access rule attribute"@en-US .
     
ao:Test rdf:type owl:Class ;
     rdfs:label "Test type"@en-US .

ao:Operation rdf:type owl:Class ;
     rdfs:label "Operation"@en-US .

ao:MetaOperation rdf:type owl:Class ;
     rdfs:label "Meta operation"@en-US .

ao:ObjectType rdf:type owl:Class ;
     rdfs:label "Object type"@en-US .

ao:AccesObject rdf:type owl:Class ;
     rdfs:label "Access object"@en-US .

ao:AttributeType rdf:type owl:Class ;
     rdfs:label "Attribute type"@en-US .
     
#### Data properties

ao:attributeName rdf:type owl:DatatypeProperty ,
            owl:FunctionalProperty ;
            rdfs:domain ao:Attribute ;
            rdfs:range xsd:string ;
            rdfs:label "Attribute name"@en-US .

ao:id rdf:type owl:DatatypeProperty ,
            owl:FunctionalProperty ;
            rdfs:domain ao:AttributeType ;
            rdfs:range xsd:string ;
            rdfs:label "id"@en-US .

ao:stringValue rdf:type owl:DatatypeProperty ,
            owl:FunctionalProperty ;
            rdfs:range xsd:string ;
            rdfs:label "id"@en-US .            

ao:priority rdf:type owl:DatatypeProperty ,
            owl:FunctionalProperty ;
            rdfs:range xsd:integer ;
            rdfs:label "priority"@en-US . 
            
#### Object properties

ao:attribute rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Rule ;
          rdfs:range ao:Attribute .
          
ao:rules rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Policy ;
          rdfs:range ao:Rules .

ao:testDatasets rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Policy ;
          rdfs:range ao:TestDatasets .

ao:testData rdf:type owl:ObjectProperty ;
          rdfs:domain ao:TestDatasets ;
          rdfs:range ao:TestData .

ao:uri rdf:type owl:ObjectProperty .

ao:value rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Attribute .
          
ao:setValue rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Attribute .          
    
ao:operation rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Rule ;
          rdfs:range ao:Operation .
          
ao:rule rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Policy ;
          rdfs:range ao:Rule .

ao:object rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Rule ;
          rdfs:range ao:object .
          
ao:keyObjectType rdf:type owl:ObjectProperty ;
          rdfs:domain ao:PolicyKey ;
          rdfs:range ao:ObjectType .
          
ao:keyRoleUri rdf:type owl:ObjectProperty ;
          rdfs:domain ao:PolicyKey .
          
ao:keyMetaOperation rdf:type owl:ObjectProperty ;
          rdfs:domain ao:PolicyKey ;
          rdfs:range ao:MetaOperation .      
          
ao:policyKey rdf:type owl:ObjectProperty ;
          rdfs:domain ao:Policy ;
          rdfs:range ao:PolicyKey .            
          
##### Individuals
         
### Tests
ai:Equals rdf:type ao:Test;
         ao:id "EQUALS" ;
         rdfs:label "Test if attribute value equals to..." .

ai:NotEquals rdf:type ao:Test;
         ao:id "NOT_EQUALS" ;
         rdfs:label "Test if attribute value not equals to..." .

### Attribute types
ai:Subject rdf:type ao:AttributeType ;
         ao:id "SUBJECT" .

ai:SubjectRole rdf:type ao:AttributeType ;
         ao:id "SUBJECT_ROLE_URI" .

ai:ObjectUri rdf:type ao:AttributeType ;
         ao:id "OBJECT_URI" .
         
ai:ObjectType rdf:type ao:AttributeType ;
         ao:id "OBJECT_TYPE" .

ai:Operation rdf:type ao:AttributeType ;
         ao:id "OPERATION" .
         
ai:SubjectNotMatch rdf:type ao:AttributeType ;
         ao:id "SUBJECT_NOT_MATCH" .
         
ai:ObjectNotMatch rdf:type ao:AttributeType ;
         ao:id "OBJECT_NOT_MATCH" .
         
ai:SubjectNotMatch rdf:type ao:AttributeType ;
         ao:id "SUBJECT_NOT_MATCH" .
         
ai:ObjectNotMatch rdf:type ao:AttributeType ;
         ao:id "OBJECT_NOT_MATCH" .
         
ai:RelatesToSubjectProfile rdf:type ao:AttributeType ;
         ao:id "RELATES_TO_SUBJECT_PROFILE" .
         
ai:StatementPredicateUri rdf:type ao:AttributeType ;
         ao:id "STATEMENT_PREDICATE_URI" .

ai:ObjectPropertyUri rdf:type ao:AttributeType ;
         ao:id "OBJECT_PROPERTY_URI" .
         
ai:DataPropertyUri rdf:type ao:AttributeType ;
         ao:id "DATA_PROPERTY_URI" .

### Object types
     
ai:ObjectPropertyAccesObject rdf:type ao:ObjectType ;
     ao:id "OBJECT_PROPERTY" .

ai:DataPropertyAccesObject rdf:type ao:ObjectType ;
     ao:id "DATA_PROPERTY" .
     
ai:FauxPropertyAccesObject rdf:type ao:ObjectType ;
     ao:id "FAUX_PROPERTY" .
     
ai:ObjectPropertyStatementAccesObject rdf:type ao:ObjectType ;
     ao:id "OBJECT_PROPERTY_STATEMENT" .

ai:DataPropertyStatementAccesObject rdf:type ao:ObjectType ;
     ao:id "DATA_PROPERTY_STATEMENT" .

ai:Class rdf:type ao:ObjectType ;
     ao:id "CLASS" .

### Operations
ai:DisplayOperation rdf:type ao:Operation ;
         ao:id "DISPLAY" .
         
ai:UpdateOperation rdf:type ao:Operation ;
         ao:id "UPDATE" .
         
ai:PublishOperation rdf:type ao:Operation ;
         ao:id "PUBLISH" .         

ai:AddOperation rdf:type ao:Operation ;
         ao:id "ADD" .
         
ai:DropOperation rdf:type ao:Operation ;
         ao:id "DROP" .

ai:EditOperation rdf:type ao:Operation ;
         ao:id "EDIT" .

ai:ExecuteOperation rdf:type ao:Operation ;
         ao:id "EXECUTE" .

### Meta operations

ai:MetaDisplayOperation rdf:type ao:MetaOperation ;
         ao:id "META_DISPLAY" .
         
ai:MetaUpdateOperation rdf:type ao:MetaOperation ;
         ao:id "META_UPDATE" .
         
ai:MetaPublishOperation rdf:type ao:MetaOperation ;
         ao:id "META_PUBLISH" .         

### Access objects

### Object property access objects
ai:RdfsLabelObjectProperty rdf:type ao:ObjectPropertyAccesObject ;
         ao:uri rdfs:label .

### Policies

ai:ObjectPropertyDisplayPolicy rdf:type ao:Policy ;
          ao:rules ai:ObjectPropertyDisplayRuleSet ;
          ao:testDatasets ai:ObjectPropertyDisplayTestDatasets ;
          ao:policyKey ai:ObjectPropertyDisplayPolicyKey .
                   
### RuleSets

ai:ObjectPropertyDisplayRuleSet rdf:type ao:Rules ;
          ao:rule ai:AllowUpdateRdfsLabelToAdminsRule .

### TestDatasets

ai:ObjectPropertyDisplayTestDatasets rdf:type ao:TestDatasets ;
          ao:testDataset ai:firstDataset .

### TestDataset

ai:firstDataset rdf:type ao:TestDataSet ;
          ao:testData ai:RdfsLabelTestData .
          
### TestData

ai:RdfsLabelTestData rdf:type ao:TestData ;
          ai:dataValue rdfs:label .

### Policy keys

ai:ObjectPropertyDisplayPolicyKey rdf:type ao:PolicyKey ;
          ao:keyObjectType ai:ObjectPropertyAccesObject ;
          ao:keyRoleUri auth:ADMIN ;
          ao:keyMetaOperation ai:MetaDisplayOperation .

### Rules

ai:AllowUpdateRdfsLabelToAdminsRule rdf:type ao:Rule;
          ao:attribute ai:SubjectRoleEqualsAdminRoleAttribute ;
          ao:attribute ai:UpdateOperationAttribute ;
          ao:attribute ai:ObjectPropertyTypeAttribute ;
          ao:attribute ai:RdfsLabelAttribute .

ai:AllowDisplayRdfsLabelToAdminsRule rdf:type ao:Rule;
          ao:attribute ai:SubjectRoleEqualsAdminRoleAttribute ;
          ao:attribute ai:DisplayOperationAttribute ;
          ao:attribute ai:ObjectPropertyTypeAttribute ;
          ao:attribute ai:RdfsLabelAttribute .
          
ai:AllowPublishRdfsLabelToAdminsRule rdf:type ao:Rule;
          ao:attribute ai:SubjectRoleEqualsAdminRoleAttribute ;
          ao:attribute ai:PublishOperationAttribute ;
          ao:attribute ai:ObjectPropertyTypeAttribute ;
          ao:attribute ai:RdfsLabelAttribute .

### Attributes
ai:SubjectRoleEqualsAdminRoleAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:SubjectRole ;
         
         ao:value auth:ADMIN .
         
ai:DisplayOperationAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:Operation ;
         
         ao:value ai:DisplayOperation .
         
ai:PublishOperationAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:Operation ;
         ao:value ai:PublishOperation .
         
ai:UpdateOperationAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:Operation ;
         
         ao:value ai:UpdateOperation .
         
ai:RdfsLabelAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:ObjectUri ;
         ao:setValue ai:RdfsLabelTestData .
         
ai:ObjectPropertyTypeAttribute rdf:type ao:Attribute ;
         ao:test ai:Equals ;
         ao:type ai:ObjectType ;
         
         ao:value ai:ObjectPropertyAccesObject .


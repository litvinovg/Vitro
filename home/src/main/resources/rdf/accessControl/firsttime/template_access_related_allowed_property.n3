# $This file is distributed under the terms of the license in LICENSE$

@prefix auth: <http://vitro.mannlib.cornell.edu/ns/vitro/authorization#> .
@prefix access-individual: <https://vivoweb.org/ontology/vitro-application/auth/individual/> .
@prefix access: <https://vivoweb.org/ontology/vitro-application/auth/vocabulary/> .
@prefix : <https://vivoweb.org/ontology/vitro-application/auth/individual/related-allowed-property/> .

:PolicyTemplate a access:PolicyTemplate ;
    access:hasRule :AllowMatchingPropertyStatement ;
    access:hasRule :AllowMatchingProperty ;

    access:hasDataSet :SelfEditorDisplayObjectPropertyDataSet ;
    access:hasDataSet :SelfEditorDisplayDataPropertyDataSet ;
    access:hasDataSet :SelfEditorDisplayFauxObjectPropertyDataSet ;
    access:hasDataSet :SelfEditorDisplayFauxDataPropertyDataSet ;
    access:hasDataSet :SelfEditorPublishObjectPropertyDataSet ;
    access:hasDataSet :SelfEditorPublishDataPropertyDataSet ;
    access:hasDataSet :SelfEditorPublishFauxObjectPropertyDataSet ;
    access:hasDataSet :SelfEditorPublishFauxDataPropertyDataSet ;
    .

### Display object property data sets

:SelfEditorDisplayObjectPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorDisplayObjectPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:ObjectPropertyValueSet ;
    access:dataSetValues access-individual:ObjectPropertyStatementValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :SelfEditorDisplayObjectPropertyValueSet .

:SelfEditorDisplayObjectPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:ObjectProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:DisplayOperation .

### Display data property data sets

:SelfEditorDisplayDataPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorDisplayDataPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:DataPropertyValueSet ;
    access:dataSetValues access-individual:DataPropertyStatementValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :SelfEditorDisplayDataPropertyValueSet .

:SelfEditorDisplayDataPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:DataProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:DisplayOperation .

### Display faux object property data sets

:SelfEditorDisplayFauxObjectPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorDisplayFauxObjectPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:FauxObjectPropertyValueSet ;
    access:dataSetValues access-individual:FauxObjectPropertyStatementValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :SelfEditorDisplayFauxObjectPropertyValueSet .

:SelfEditorDisplayFauxObjectPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:FauxObjectProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:DisplayOperation .

### Display faux data property data sets

:SelfEditorDisplayFauxDataPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorDisplayFauxDataPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:FauxDataPropertyValueSet ;
    access:dataSetValues access-individual:FauxDataPropertyStatementValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :SelfEditorDisplayFauxDataPropertyValueSet .

:SelfEditorDisplayFauxDataPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:FauxDataProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:DisplayOperation .

### Publish object property data sets

:SelfEditorPublishObjectPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorPublishObjectPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:ObjectPropertyValueSet ;
    access:dataSetValues access-individual:ObjectPropertyStatementValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :SelfEditorPublishObjectPropertyValueSet .

:SelfEditorPublishObjectPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:ObjectProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:PublishOperation .

### Publish data property data sets

:SelfEditorPublishDataPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorPublishDataPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:DataPropertyValueSet ;
    access:dataSetValues access-individual:DataPropertyStatementValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :SelfEditorPublishDataPropertyValueSet .

:SelfEditorPublishDataPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:DataProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:PublishOperation .

### Publish faux object property data sets

:SelfEditorPublishFauxObjectPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorPublishFauxObjectPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:FauxObjectPropertyValueSet ;
    access:dataSetValues access-individual:FauxObjectPropertyStatementValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :SelfEditorPublishFauxObjectPropertyValueSet .

:SelfEditorPublishFauxObjectPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:FauxObjectProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:PublishOperation .

### Publish faux data property data sets

:SelfEditorPublishFauxDataPropertyDataSet a access:DataSet ;
    access:dataSetKey :SelfEditorPublishFauxDataPropertyDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:FauxDataPropertyValueSet ;
    access:dataSetValues access-individual:FauxDataPropertyStatementValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :SelfEditorPublishFauxDataPropertyValueSet .

:SelfEditorPublishFauxDataPropertyDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:FauxDataProperty ;
    access:keyComponent access-individual:SelfEditorRoleUri ;
    access:keyComponent access-individual:PublishOperation .

:AllowMatchingProperty a access:Rule;
    access:requiresCheck :SubjectRoleCheck ;
    access:requiresCheck :OperationCheck ;
    access:requiresCheck :AccessObjectTypeCheck ;
    access:requiresCheck :AccessObjectUriCheck .

:AccessObjectTypeCheck a access:Check ;
    access:useOperator access-individual:Equals ;
    access:attribute access-individual:AccessObjectType ;
    access:values access-individual:ObjectPropertyValueSet ;
    access:values access-individual:DataPropertyValueSet ;
    access:values access-individual:FauxObjectPropertyValueSet ;
    access:values access-individual:FauxDataPropertyValueSet ;
    .

:AllowMatchingPropertyStatement a access:Rule;
    access:requiresCheck :SubjectRoleCheck ;
    access:requiresCheck :OperationCheck ;
    access:requiresCheck :AccessObjectStatementTypeCheck ;
    access:requiresCheck :StatementPredicateCheck ;
    .

:AccessObjectStatementTypeCheck a access:Check ;
    access:useOperator access-individual:Equals ;
    access:attribute access-individual:AccessObjectType ;
    access:values access-individual:ObjectPropertyStatementValueSet ;
    access:values access-individual:DataPropertyStatementValueSet ;
    access:values access-individual:FauxObjectPropertyStatementValueSet ;
    access:values access-individual:FauxDataPropertyStatementValueSet ;
    .

:OperationCheck a access:Check ;
    access:useOperator access-individual:Equals ;
    access:attribute access-individual:Operation ;
    access:values access-individual:DisplayOperationValueSet ;
    access:values access-individual:PublishOperationValueSet ;
    .

:SubjectRoleCheck a access:Check ;
    access:useOperator access-individual:Equals ;
    access:attribute access-individual:SubjectRole ;
    access:values access-individual:SelfEditorRoleValueSet .

:StatementPredicateCheck a access:Check ;
    access:useOperator access-individual:OneOf ;
    access:attribute access-individual:StatementPredicateUri ;
    access:values :SelfEditorDisplayObjectPropertyValueSet ;
    access:values :SelfEditorDisplayDataPropertyValueSet ;
    access:values :SelfEditorDisplayFauxObjectPropertyValueSet ;
    access:values :SelfEditorDisplayFauxDataPropertyValueSet ;
    access:values :SelfEditorPublishObjectPropertyValueSet ;
    access:values :SelfEditorPublishDataPropertyValueSet ;
    access:values :SelfEditorPublishFauxObjectPropertyValueSet ;
    access:values :SelfEditorPublishFauxDataPropertyValueSet ;
    .

:AccessObjectUriCheck a access:Check ;
    access:useOperator access-individual:OneOf ;
    access:attribute access-individual:AccessObjectUri ;
    access:values :SelfEditorDisplayObjectPropertyValueSet ;
    access:values :SelfEditorDisplayDataPropertyValueSet ;
    access:values :SelfEditorDisplayFauxObjectPropertyValueSet ;
    access:values :SelfEditorDisplayFauxDataPropertyValueSet ;
    access:values :SelfEditorPublishObjectPropertyValueSet ;
    access:values :SelfEditorPublishDataPropertyValueSet ;
    access:values :SelfEditorPublishFauxObjectPropertyValueSet ;
    access:values :SelfEditorPublishFauxDataPropertyValueSet ;
    .

:SelfEditorDisplayObjectPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:ObjectProperty .
:SelfEditorDisplayDataPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:DataProperty .
:SelfEditorDisplayFauxObjectPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:FauxObjectProperty .
:SelfEditorDisplayFauxDataPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:FauxDataProperty .
:SelfEditorPublishObjectPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:ObjectProperty .
:SelfEditorPublishDataPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:DataProperty .
:SelfEditorPublishFauxObjectPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:FauxObjectProperty .
:SelfEditorPublishFauxDataPropertyValueSet a access:ValueSet ;
    access:containsElementsOfType access-individual:FauxDataProperty .

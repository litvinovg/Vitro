# $This file is distributed under the terms of the license in LICENSE$

@prefix auth: <http://vitro.mannlib.cornell.edu/ns/vitro/authorization#> .
@prefix access-individual: <https://vivoweb.org/ontology/vitro-application/auth/individual/> .
@prefix access: <https://vivoweb.org/ontology/vitro-application/auth/vocabulary/> .
@prefix : <https://vivoweb.org/ontology/vitro-application/auth/individual/access-allowed-class/> .

:PolicyTemplate a access:PolicyTemplate ;
    access:rule :AllowMatchingClass ;

    access:policyDataSet :PublicDisplayClassDataSet ;
    access:policyDataSet :SelfEditorDisplayClassDataSet ;
    access:policyDataSet :EditorDisplayClassDataSet ;
    access:policyDataSet :CuratorDisplayClassDataSet ;
    access:policyDataSet :AdminDisplayClassDataSet ;

    access:policyDataSet :PublicUpdateClassDataSet ;
    access:policyDataSet :SelfEditorUpdateClassDataSet ;
    access:policyDataSet :EditorUpdateClassDataSet ;
    access:policyDataSet :CuratorUpdateClassDataSet ;
    access:policyDataSet :AdminUpdateClassDataSet ;

    access:policyDataSet :SelfEditorPublishClassDataSet ;
    access:policyDataSet :EditorPublishClassDataSet ;
    access:policyDataSet :CuratorPublishClassDataSet ;
    access:policyDataSet :AdminPublishClassDataSet ;

    access:policyDataSetTemplate :RoleDisplayClassDataSetTemplate ;
    access:policyDataSetTemplate :RoleUpdateClassDataSetTemplate ;
    access:policyDataSetTemplate :RolePublishClassDataSetTemplate ;
    .

#Role Display Class data set template

:RoleDisplayClassDataSetTemplate a access:DataSetTemplate ;
    access:dataSetTemplateKey :RoleDisplayClassDataSetTemplateKey ;
    access:dataSetKeyTemplate :RoleDisplayClassDataSetKeyTemplate ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValueTemplate :RoleDisplayClassRoleValueSetTemplate ;
    access:dataSetValueTemplate :RoleDisplayClassValueSetTemplate .  

:RoleDisplayClassDataSetTemplateKey a access:DataSetTemplateKey ;
    access:templateKey access-individual:SubjectRole .

:RoleDisplayClassDataSetKeyTemplate a access:DataSetKeyTemplate ;
    access:keyComponent access-individual:Class ;
    access:keyComponent access-individual:DisplayOperation ;
    access:keyComponentTemplate access-individual:SubjectRole .

:RoleDisplayClassRoleValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :SubjectRoleCheck;
    access:containerTypeTemplate access-individual:SubjectRole .

:RoleDisplayClassValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :AccessObjectUriCheck ;
#    access:defaultValue access-individual:defaultUri ;
    access:containerTypeTemplate access-individual:Class .

#Role Update Class data set template

:RoleUpdateClassDataSetTemplate a access:DataSetTemplate ;
    access:dataSetTemplateKey :RoleUpdateClassDataSetTemplateKey ;
    access:dataSetKeyTemplate :RoleUpdateClassDataSetKeyTemplate ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValueTemplate :RoleUpdateClassRoleValueSetTemplate ;
    access:dataSetValueTemplate :RoleUpdateClassValueSetTemplate .  

:RoleUpdateClassDataSetTemplateKey a access:DataSetTemplateKey ;
    access:templateKey access-individual:SubjectRole .

:RoleUpdateClassDataSetKeyTemplate a access:DataSetKeyTemplate ;
    access:keyComponent access-individual:Class ;
    access:keyComponent access-individual:UpdateOperation ;
    access:keyComponentTemplate access-individual:SubjectRole .

:RoleUpdateClassRoleValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :SubjectRoleCheck;
    access:containerTypeTemplate access-individual:SubjectRole .

:RoleUpdateClassValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :AccessObjectUriCheck ;
#    access:defaultValue access-individual:defaultUri ;
    access:containerTypeTemplate access-individual:Class .

#Role Publish Class data set template

:RolePublishClassDataSetTemplate a access:DataSetTemplate ;
    access:dataSetTemplateKey :RolePublishClassDataSetTemplateKey ;
    access:dataSetKeyTemplate :RolePublishClassDataSetKeyTemplate ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValueTemplate :RolePublishClassRoleValueSetTemplate ;
    access:dataSetValueTemplate :RolePublishClassValueSetTemplate .  

:RolePublishClassDataSetTemplateKey a access:DataSetTemplateKey ;
    access:templateKey access-individual:SubjectRole .

:RolePublishClassDataSetKeyTemplate a access:DataSetKeyTemplate ;
    access:keyComponent access-individual:Class ;
    access:keyComponent access-individual:PublishOperation ;
    access:keyComponentTemplate access-individual:SubjectRole .

:RolePublishClassRoleValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :SubjectRoleCheck;
    access:containerTypeTemplate access-individual:SubjectRole .

:RolePublishClassValueSetTemplate a access:ValueSetTemplate ;
    access:relatedCheck :AccessObjectUriCheck ;
#    access:defaultValue access-individual:defaultUri ;
    access:containerTypeTemplate access-individual:Class .

### Public display class uri data sets

:PublicDisplayClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :PublicDisplayClassDataSetKey ;
    access:dataSetValues access-individual:PublicRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :PublicDisplayClassValueSet .

:PublicDisplayClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:PUBLIC ;
    access:keyComponent access-individual:DisplayOperation .

### Self editor display class uri data sets

:SelfEditorDisplayClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :SelfEditorDisplayClassDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :SelfEditorDisplayClassValueSet .

:SelfEditorDisplayClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:SELF_EDITOR ;
    access:keyComponent access-individual:DisplayOperation .

### Editor display class uri data sets

:EditorDisplayClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :EditorDisplayClassDataSetKey ;
    access:dataSetValues access-individual:EditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :EditorDisplayClassValueSet .

:EditorDisplayClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:EDITOR ;
    access:keyComponent access-individual:DisplayOperation .

### Curator display class uri data sets

:CuratorDisplayClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :CuratorDisplayClassDataSetKey ;
    access:dataSetValues access-individual:CuratorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :CuratorDisplayClassValueSet .

:CuratorDisplayClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:CURATOR ;
    access:keyComponent access-individual:DisplayOperation .

### Admin display class uri data sets

:AdminDisplayClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :AdminDisplayClassDataSetKey ;
    access:dataSetValues access-individual:AdminRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:DisplayOperationValueSet ;
    access:dataSetValues :AdminDisplayClassValueSet .

:AdminDisplayClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:ADMIN ;
    access:keyComponent access-individual:DisplayOperation .

### Public update class uri data sets

:PublicUpdateClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :PublicUpdateClassDataSetKey ;
    access:dataSetValues access-individual:PublicRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValues :PublicUpdateClassValueSet .

:PublicUpdateClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:PUBLIC ;
    access:keyComponent access-individual:UpdateOperation .

### Self editor update class uri data sets

:SelfEditorUpdateClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :SelfEditorUpdateClassDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValues :SelfEditorUpdateClassValueSet .

:SelfEditorUpdateClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:SELF_EDITOR ;
    access:keyComponent access-individual:UpdateOperation .

### Editor update class uri data sets

:EditorUpdateClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :EditorUpdateClassDataSetKey ;
    access:dataSetValues access-individual:EditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValues :EditorUpdateClassValueSet .

:EditorUpdateClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:EDITOR ;
    access:keyComponent access-individual:UpdateOperation .

### Curator update class uri data sets

:CuratorUpdateClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :CuratorUpdateClassDataSetKey ;
    access:dataSetValues access-individual:CuratorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValues :CuratorUpdateClassValueSet .

:CuratorUpdateClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:CURATOR ;
    access:keyComponent access-individual:UpdateOperation .

### Admin update class uri data sets

:AdminUpdateClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :AdminUpdateClassDataSetKey ;
    access:dataSetValues access-individual:AdminRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:UpdateOperationValueSet ;
    access:dataSetValues :AdminUpdateClassValueSet .

:AdminUpdateClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:ADMIN ;
    access:keyComponent access-individual:UpdateOperation .

### Self editor publish class uri data sets

:SelfEditorPublishClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :SelfEditorPublishClassDataSetKey ;
    access:dataSetValues access-individual:SelfEditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :SelfEditorPublishClassValueSet .

:SelfEditorPublishClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:SELF_EDITOR ;
    access:keyComponent access-individual:PublishOperation .

### Editor publish class uri data sets

:EditorPublishClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :EditorPublishClassDataSetKey ;
    access:dataSetValues access-individual:EditorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :EditorPublishClassValueSet .

:EditorPublishClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:EDITOR ;
    access:keyComponent access-individual:PublishOperation .

### Curator publish class uri data sets

:CuratorPublishClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :CuratorPublishClassDataSetKey ;
    access:dataSetValues access-individual:CuratorRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :CuratorPublishClassValueSet .

:CuratorPublishClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:CURATOR ;
    access:keyComponent access-individual:PublishOperation .

### Admin publish class uri data sets

:AdminPublishClassDataSet a access:PolicyDataSet ;
    access:dataSetKey :AdminPublishClassDataSetKey ;
    access:dataSetValues access-individual:AdminRoleValueSet ;
    access:dataSetValues access-individual:ClassValueSet ;
    access:dataSetValues access-individual:PublishOperationValueSet ;
    access:dataSetValues :AdminPublishClassValueSet .

:AdminPublishClassDataSetKey a access:DataSetKey ;
    access:keyComponent access-individual:Class ;
    access:keyComponent auth:ADMIN ;
    access:keyComponent access-individual:PublishOperation .

:AllowMatchingClass a access:Rule;
    access:check :SubjectRoleCheck ;
    access:check :OperationCheck ;
    access:check :AccessObjectTypeCheck ;
    access:check :AccessObjectUriCheck .

:AccessObjectTypeCheck a access:Check ;
    access:operator access-individual:Equals ;
    access:attribute access-individual:AccessObjectType ;
    access:attributeValue access-individual:ClassValueSet ;
    .

:OperationCheck a access:Check ;
    access:operator access-individual:Equals ;
    access:attribute access-individual:Operation ;
    access:attributeValue access-individual:DisplayOperationValueSet ;
    access:attributeValue access-individual:PublishOperationValueSet ;
    access:attributeValue access-individual:UpdateOperationValueSet ;
    .

:SubjectRoleCheck a access:Check ;
    access:operator access-individual:Equals ;
    access:attribute access-individual:SubjectRole ;
    access:attributeValue access-individual:PublicRoleValueSet ;
    access:attributeValue access-individual:SelfEditorRoleValueSet ;
    access:attributeValue access-individual:EditorRoleValueSet ;
    access:attributeValue access-individual:CuratorRoleValueSet ;
    access:attributeValue access-individual:AdminRoleValueSet .

:AccessObjectUriCheck a access:Check ;
    access:operator access-individual:OneOf ;
    access:attribute access-individual:AccessObjectUri ;
    access:attributeValue :AdminPublishClassValueSet ;
    access:attributeValue :AdminDisplayClassValueSet ;
    access:attributeValue :AdminUpdateClassValueSet ;
    access:attributeValue :CuratorPublishClassValueSet ;
    access:attributeValue :CuratorDisplayClassValueSet ;
    access:attributeValue :CuratorUpdateClassValueSet ;
    access:attributeValue :EditorPublishClassValueSet ;
    access:attributeValue :EditorDisplayClassValueSet ;
    access:attributeValue :EditorUpdateClassValueSet ;
    access:attributeValue :SelfEditorPublishClassValueSet ;
    access:attributeValue :SelfEditorDisplayClassValueSet ;
    access:attributeValue :SelfEditorUpdateClassValueSet ;
    access:attributeValue :PublicDisplayClassValueSet ;
    access:attributeValue :PublicUpdateClassValueSet ;
    .

:AdminPublishClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:AdminDisplayClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:AdminUpdateClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:CuratorPublishClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:CuratorDisplayClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:CuratorUpdateClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:EditorPublishClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:EditorDisplayClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:EditorUpdateClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:SelfEditorPublishClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:SelfEditorDisplayClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:SelfEditorUpdateClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:PublicDisplayClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

:PublicUpdateClassValueSet a access:ValueSet ;
    access:containerType access-individual:Class .

# $This file is distributed under the terms of the license in LICENSE$

@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <https://vivoweb.org/ontology/vitro-application/auth/vocabulary/> .

### Ontology

<https://vivoweb.org/ontology/vitro-application/auth/vocabulary> a owl:Ontology .

### Classes

:PolicyTemplate a owl:Class ;
    rdfs:comment "Policy template to define set of rules that can be reused by data sets" ; 
    rdfs:label "Policy template"@en-US .

:Policy a owl:Class ;
    rdfs:comment "Policy to define access rules" ; 
    rdfs:label "Policy"@en-US .

:PolicyDataSet a owl:Class ;
    rdfs:comment "Data set to load policy instance with values defined in it. Contains value containers used by checks. While loading policy from data set value containers not specified in current data set are ignored (not used by checks)." ;
    rdfs:label "Policy dataset"@en-US .

:ValueContainer a owl:Class ;
    rdfs:comment "Container for values" ; 
    rdfs:label "Value container"@en-US .

:Rule a owl:Class ;
    rdfs:comment "Contains checks to perform. If all checks match, rule returns decision.";
    rdfs:label "Access rule"@en-US .

:Rules a owl:Class ;
    rdfs:comment "Container for rules";
    rdfs:label "Access rule set"@en-US .

:Check a owl:Class ;
    rdfs:comment "Check to perform on attribute of request";
    rdfs:label "Access rule check"@en-US .

:Operator a owl:Class ;
    rdfs:comment "Operator to use in check";
    rdfs:label "Operator"@en-US .

:Operation a owl:Class ;
    rdfs:comment "Access operation";
    rdfs:label "Operation"@en-US .

:ObjectType a owl:Class ;
    rdfs:comment "Type of access object";
    rdfs:label "Object type"@en-US .

:SubjectType a owl:Class ;
    rdfs:comment "Type of subject(user, non-personal entity) requested access";
    rdfs:label "Subject type"@en-US .

:Attribute a owl:Class ;
    rdfs:comment "Attribute to check";
    rdfs:label "Attribute"@en-US .

:AttributeValue a owl:Class ;
    rdfs:comment "Resource represents single attribute value, usually specified as literal with :id ";
    rdfs:label "Attribute value"@en-US .

:Decision a owl:Class ;
    rdfs:comment "Decision to return in case all checks in a rule match";
    rdfs:label "Decision"@en-US .

:DataSetTemplate a owl:Class ;
    rdfs:comment "Data set template to create new data set: specify new value containers and add them into attribute value sets, create new data set key. Data set template should contain it's own key to be found and used. For example on new role creation new data sets for new role should be created, template key for that example would be access-individual:SubjectRole";
    rdfs:label "Data set template"@en-US .

:DataSetTemplateKey a owl:Class ;
    rdfs:comment "Key to find template";
    rdfs:label "Data set template key"@en-US .

:DataSetKeyTemplate a owl:Class ;
    rdfs:comment "Template of data set key to find data set";
    rdfs:label "Data set key template"@en-US .

:ValueContainerTemplate a owl:Class ;
    rdfs:comment "Template to create new value container from";
    rdfs:label "Value container template"@en-US .
    
:Configuration a owl:Class ;
    rdfs:comment "Access control configuration";
    rdfs:label "Configuration"@en-US .

### Data properties

:id a owl:DatatypeProperty ,
    owl:FunctionalProperty ;
    rdfs:comment "Set string identifier";
    rdfs:range xsd:string ;
    rdfs:domain [ a owl:Class ; owl:unionOf  ( :Operator :Operation :Decision :AttributeValue :SubjectType :Attribute :ObjectType ) ] ;
    rdfs:label "id"@en-US .

:priority a owl:DatatypeProperty ,
    owl:FunctionalProperty ;
    rdfs:comment "Set priority to :Policy, :PolicyTemplate or :PolicyDataSet";
    rdfs:range xsd:integer ;
    rdfs:domain [ a owl:Class ; owl:unionOf  ( :Policy :PolicyTemplate :PolicyDataSet ) ] ;
    rdfs:label "priority"@en-US . 
    
:version a owl:DatatypeProperty ,
    owl:FunctionalProperty ;
    rdfs:comment "Access control configuration version";
    rdfs:range xsd:integer ;
    rdfs:domain :Configuration ;
    rdfs:label "version"@en-US .

### Object properties

:dataSetValues a owl:ObjectProperty ;
    rdfs:comment "Data set/data set template contains value container";
    rdfs:label "data set values"@en-US ;
    rdfs:domain [ a owl:Class ; owl:unionOf  ( :DataSetTemplate :PolicyDataSet ) ] ;
    rdfs:range :ValueContainer .

:value a owl:ObjectProperty ;
    rdfs:comment "Assign value to value container (any URI or :AttributeValue with :id to define literal value)";
    rdfs:label "value"@en-US ;
    rdfs:domain :ValueContainer .

:operator a owl:ObjectProperty ;
    rdfs:comment "Set type of check to perform";
    rdfs:label "operator"@en-US ;
    rdfs:domain :Check ;
    rdfs:range :Operator .

:attribute a owl:ObjectProperty ;
    rdfs:comment "Set attribute that should be checked";
    rdfs:label "attribute"@en-US ;
    rdfs:domain :Check ;
    rdfs:range :Attribute .

:defaultValue a owl:ObjectProperty ;
    rdfs:comment "default value to add into new value container";
    rdfs:label "default template value"@en-US ;
    rdfs:domain :ValueContainerTemplate .

:containerTypeTemplate a owl:ObjectProperty ,
    owl:FunctionalProperty ;
    rdfs:comment "Type of values for new value container";
    rdfs:label "container type template"@en-US ;
    rdfs:range [ a owl:Class ; owl:unionOf  ( :Attribute :ObjectType ) ] ;
    rdfs:domain :ValueContainerTemplate .

:attributeValue a owl:ObjectProperty ;
    rdfs:comment "Check contains value container";
    rdfs:label "attribute value"@en-US ;
    rdfs:domain :Check ;
    rdfs:range :ValueContainer .

:relatedValueSet a owl:ObjectProperty ;
    rdfs:comment "Specify :Check into which new ValueContainer should be added";
    rdfs:label "related value set"@en-US ;
    rdfs:domain :ValueContainerTemplate ;
    rdfs:range :Check .

:dataSetTemplateKey a owl:ObjectProperty, 
    owl:FunctionalProperty ;
    rdfs:comment "Specify data set template key";
    rdfs:label "data set template key"@en-US ;
    rdfs:domain :DataSetTemplate ;
    rdfs:range :DataSetTemplateKey .

:dataSetValueTemplate a owl:ObjectProperty ;
    rdfs:comment "Contains value container template";
    rdfs:label "data set value template"@en-US ;
    rdfs:domain :DataSetTemplate ;
    rdfs:range :ValueContainerTemplate .

:templateKey a owl:ObjectProperty ;
    rdfs:comment "Attribute to use as a template key";
    rdfs:label "template key"@en-US ;
    rdfs:domain :DataSetTemplateKey ;
    rdfs:range :Attribute .

:check a owl:ObjectProperty ;
    rdfs:comment "contains check";
    rdfs:label "check"@en-US ;
    rdfs:domain :Rule ;
    rdfs:range :Check .

:decision a owl:ObjectProperty ;
    rdfs:comment "Decision to return in case of all checks match";
    rdfs:label "decision"@en-US ;
    rdfs:domain :Rule ;
    rdfs:range :Decision .    

:rules a owl:ObjectProperty ;
    rdfs:comment "Contains rules";
    rdfs:label "rules"@en-US ;
    rdfs:domain [ a owl:Class ; owl:unionOf  ( :Policy :PolicyTemplate ) ] ;
    rdfs:range :Rules .

:policyDataSets a owl:ObjectProperty ;
    rdfs:comment "Contains policy data sets";
    rdfs:label "policy data sets"@en-US ;
    rdfs:domain [ a owl:Class ; owl:unionOf  ( :Policy :PolicyTemplate ) ] ;
    rdfs:range :PolicyDataSets .

:policyDataSet a owl:ObjectProperty ;
    rdfs:comment "Data sets container contain data set";
    rdfs:label "policy data set"@en-US ;
    rdfs:domain :PolicyDataSets ;
    rdfs:range :PolicyDataSet .

:containerType a owl:ObjectProperty ;
    rdfs:comment "Specifies type of container values";
    rdfs:label "container type"@en-US ;
    rdfs:domain :ValueContainer ;
    rdfs:range :ObjectType .

:singleValue a owl:ObjectProperty ;
    rdfs:comment "Contains single value to check";
    rdfs:label "single value"@en-US ;
    rdfs:domain :Check .

:rule a owl:ObjectProperty ;
    rdfs:comment "Contains a rule";
    rdfs:label "rule"@en-US ;
    rdfs:domain :Rules ;
    rdfs:range :Rule .

:dataSetKey a owl:ObjectProperty ;
    rdfs:comment "Assign data set template to policy data sets";
    rdfs:label "data set key"@en-US ;
    rdfs:domain :PolicyDataSet ;
    rdfs:range :DataSetKey .

:dataSetKeyTemplate a owl:ObjectProperty ;
    rdfs:comment "Assign data set key template to data set template";
    rdfs:label "data set key template"@en-US ;
    rdfs:domain :DataSetTemplate ;
    rdfs:range :DataSetKeyTemplate .

:policyDataSetTemplate a owl:ObjectProperty ;
    rdfs:comment "Assign data set template to policy data sets";
    rdfs:label "policy data set template"@en-US ;
    rdfs:domain :PolicyDataSets ;
    rdfs:range :DataSetTemplate .

:keyComponent a owl:ObjectProperty ;
    rdfs:comment "Specify component of combined key";
    rdfs:domain [ a owl:Class ; owl:unionOf ( :DataSetKeyTemplate :DataSetKey ) ] ;
    rdfs:label "key component"@en-US .
